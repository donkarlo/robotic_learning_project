\documentclass{book}

% --- Packages (order matters) ---
\usepackage{titlesec}
\usepackage[table]{xcolor}
\usepackage{array}
\usepackage[colorinlistoftodos]{todonotes}
\setcounter{tocdepth}{4}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{svg}
\usetikzlibrary{graphs,graphdrawing,arrows.meta,mindmap,fit,positioning}
\usegdlibrary{layered,force}
\usepackage[edges]{forest}
\usepackage{float}
\usepackage{caption}
\captionsetup{singlelinecheck=false}
\usepackage{minted}
\usemintedstyle{friendly}
\setminted{
    fontsize=\small,
    linenos,
    breaklines,
    frame=single,
    tabsize=4,
    autogobble,
}
\setminted[python]{fontsize=\footnotesize}

% convenience
\newcommand{\filepath}[1]{\href{file://#1}{\path{#1}}}
\newcommand{\pyl}[1]{\mintinline{python}{#1}}

% --- Load hyperlink packages LAST ---
\usepackage[colorlinks=true]{hyperref}
\usepackage{bookmark}   % better control over PDF outline
\usepackage{etoolbox}   % to hook into \chapter

% reset outline root at every chapter
\pretocmd{\chapter}{\cleardoublepage\bookmarksetup{startatroot}}{}{}

% optional: control outline depth/appearance
\hypersetup{
    bookmarksopen=true,
    bookmarksopenlevel=2,
    bookmarksnumbered=true
}

% TikZ colors (unchanged)
\definecolor{mainfill}{HTML}{FFF2CC}
\definecolor{mainborder}{HTML}{D6B656}
\tikzset{
    mainnode/.style={
        draw=mainborder, fill=mainfill, rectangle, align=center,
        inner sep=5pt, rounded corners, line width=0.8pt, text=black,
    }
}

% loading pdf
\usepackage{pdfpages}